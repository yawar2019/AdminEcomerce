
@{
    ViewBag.Title = "CreteProduct";
    
}

<!-- themify-icons line icon -->
<link rel="stylesheet" type="text/css" href="~/assets/icon/themify-icons/themify-icons.css">
<!-- ico font -->
<link rel="stylesheet" type="text/css" href="~/assets/icon/icofont/css/icofont.css">
@*<link href="~/Content/CustomCorp.css" rel="stylesheet" />*@
<link href="~/Content/FileUpload.css" rel="stylesheet" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>


<style>
    .form-material .float-label {
        top: -12px;
    }

    .toggle.ios, .toggle-on.ios, .toggle-off.ios {
        border-radius: 20px;
    }

        .toggle.ios .toggle-handle {
            border-radius: 20px;
        }
</style>



<h2>Create Product</h2>



<div class="card-block">

    <form class="form-material" enctype="multipart/form-data">

        <div class="form-group form-default">
            <select id="brandDropDownList" class="form-control">
                <option value="Select">Select</option>
            </select>
            <span class="form-bar"></span>
            <label class="float-label"> Brand:</label>
        </div>

        <div class="form-group form-default">
            <select id="categoryDropDownList" class="form-control">
                <option value="Select">Select</option>
            </select>
            <span class="form-bar"></span>
            <label class="float-label"> Category:</label>
        </div>

        <div class="form-group form-default">
            <select id="tagDropDownList" class="form-control">
                <option value="Select">Select</option>
            </select>
            <span class="form-bar"></span>
            <label class="float-label"> Tag:</label>
        </div>

        <div class="form-group form-default">
            <label class="floatimage">Upload Image or Video(10 sec)</label>
            <input type="file" name="assertImageUrl[]" class="form-control" id="assertImageUrl" multiple>
            <span class="form-bar"></span>
        </div>
        <table id="productImgtable" class="table table-bordered ">
            <tr>
                <th>Image</th>
                <th>IsDefault</th>
                <th>IsActive</th>
                <th>Remove</th>
            </tr>
        </table>
        <div class="box-2">
            <div class="result"></div>
        </div>
        <!--rightbox-->
      
        <h2>Details</h2>
        <div class="form-group form-default">
            <input type="text" name="name_en" class="form-control" id="name_en">
            <span class="form-bar"></span>
            <label class="float-label">Name in English:</label>
        </div>
        <div class="form-group form-default">
            <input type="text" name="name_ar" class="form-control" id="name_ar">
            <span class="form-bar"></span>
            <label class="float-label">Name in Arabic:</label>
        </div>

        <div class="form-group form-default">
            <input type="text" name="name_desc_en" class="form-control" id="name_desc_en">
            <span class="form-bar"></span>
            <label class="float-label">Name Description in English:</label>
        </div>
        <div class="form-group form-default">
            <input type="text" name="footer-email" class="form-control" id="name_desc_ar">
            <span class="form-bar"></span>
            <label class="float-label">Name Description in Arabic:</label>
        </div>

        <div class="form-group form-default">
            <input type="text" name="agefrom" class="form-control" id="agefrom">
            <span class="form-bar"></span>
            <label class="float-label"> Age From:</label>
        </div>
        <div class="form-group form-default">
            <input type="text" name="agefrom" class="form-control" id="ageto">
            <span class="form-bar"></span>
            <label class="float-label"> Age To:</label>
        </div>


        <div class="form-group form-default">
            <input type="text" name="quantity" class="form-control" id="quantity">
            <span class="form-bar"></span>
            <label class="float-label">Quantity:</label>
        </div>


        <div class="form-group form-default">
            <input type="text" name="unit_price" class="form-control" id="unit_price">
            <span class="form-bar"></span>
            <label class="float-label">Unit Price:</label>
        </div>


        <div class="form-group row">
            <label class="col-sm-4 col-form-label"><span class="text-inverse"> Is Active?:</span></label>
            <div class="col-sm-8" style="padding-top:8px;">
                @* <input type="checkbox" value="" id="iscustomsizeavailable">*@
                <input type="checkbox" checked data-toggle="toggle" data-size="normal" data-style="ios" id="isactive" data-on="Yes" data-off="No">

            </div>
        </div>

        <div style="padding-bottom:15px;"><h4>Custom Size</h4></div>

        <div class="form-group row">
            <label class="col-sm-4 col-form-label"><span class="text-inverse"> Is Custom Size Available?:</span></label>
            <div class="col-sm-8" style="padding-top:8px;">
                <input type="checkbox" checked data-toggle="toggle" data-size="normal" data-style="ios" id="iscustomsizeavailable" data-on="Yes" data-off="No">

            </div>
        </div>

        <div id="sizeBlock">
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group form-default">
                        <input type="text" name="unit_price" class="form-control" id="custom_size_field1">
                        <span class="form-bar"></span>
                        <label class="float-label">Size1:</label>
                    </div>

                    <div class="form-group form-default">
                        <input type="text" name="unit_price" class="form-control" id="custom_size_field2">
                        <span class="form-bar"></span>
                        <label class="float-label">Size2:</label>
                    </div>

                    <div class="form-group form-default">
                        <input type="text" name="unit_price" class="form-control" id="custom_size_field3">
                        <span class="form-bar"></span>
                        <label class="float-label">Size3:</label>
                    </div>

                    <div class="form-group form-default">
                        <input type="text" name="unit_price" class="form-control" id="custom_size_field4">
                        <span class="form-bar"></span>
                        <label class="float-label">Size4:</label>
                    </div>
                    <div class="form-group form-default">
                        <input type="text" name="unit_price" class="form-control" id="custom_size_field5">
                        <span class="form-bar"></span>
                        <label class="float-label">Size5:</label>
                    </div>

                </div>
                <div class="col-sm-6 mobile-inputs">
                    <div class="form-group form-default">
                        <input type="text" name="unit_price" class="form-control" id="custom_size_field6">
                        <span class="form-bar"></span>
                        <label class="float-label">Size6:</label>
                    </div>
                    <div class="form-group form-default">
                        <input type="text" name="unit_price" class="form-control" id="custom_size_field7">
                        <span class="form-bar"></span>
                        <label class="float-label">Size7:</label>
                    </div>

                    <div class="form-group form-default">
                        <input type="text" name="unit_price" class="form-control" id="custom_size_field8">
                        <span class="form-bar"></span>
                        <label class="float-label">Size8:</label>
                    </div>

                    <div class="form-group form-default">
                        <input type="text" name="unit_price" class="form-control" id="custom_size_field9">
                        <span class="form-bar"></span>
                        <label class="float-label">Size9:</label>
                    </div>

                    <div class="form-group form-default">
                        <input type="text" name="unit_price" class="form-control" id="custom_size_field10">
                        <span class="form-bar"></span>
                        <label class="float-label">Size10:</label>
                    </div>
                </div>
            </div>



            <div class="form-group form-default">
                <label class="floatimage">Upload Custom Size Images</label>
                <input type="file" name="footer-email" class="form-control" id="CustomImageUpload">
                <span class="form-bar"></span>
            </div>

            <table id="ProdTable" class="table table-bordered ">
                <tr>
                    <th>Image</th>
                    <th>Remove</th>
                </tr>
            </table>

            <div class="form-group form-default">
                <input type="text" name="custom_size_description" class="form-control" id="custom_size_description">
                <span class="form-bar"></span>
                <label class="float-label">Custom Image Description:</label>
            </div>

            <div class="form-group form-default">
                <input type="text" name="custom_size_description" class="form-control" id="unit_price">
                <span class="form-bar"></span>
                <label class="float-label">Custom Image Unit Price:</label>
            </div>  
            
            <div class="form-group form-default">
                @Html.DropDownList("typeImage", new List<SelectListItem>() {
                 new SelectListItem {Text="Fixed",Value="Fixed"},
                 new SelectListItem {Text="% Unit Price",Value="%Unit Price"}
            }, new { @class = "form-control" })
                <span class="form-bar"></span>
                <label class="float-label">Extra Price Type</label>
            </div>    
        </div> 


        <div style="padding-bottom:15px;"><h4>Gift</h4></div>


        <div class="form-group row">
            <label class="col-sm-4 col-form-label"><span class="text-inverse">Is Gift Available:</span></label>
            <div class="col-sm-8" style="padding-top:8px;"> 
                <input type="checkbox" checked data-toggle="toggle" data-size="normal" data-style="ios" id="isgiftavailable" data-on="Available" data-off="Not Available">

            </div>
        </div>
        <div id="GiftBlock">
            <div class="form-group form-default">
                <label class="floatimage">Upload Gift Card Images</label>
                <input type="file" name="GiftCardImage[]" class="form-control" id="GiftCardImage">
                <span class="form-bar"></span>
            </div>

     5        <div class="form-group form-default">
                <input type="text" name="GiftOrderBy" class="form-control" id="GiftOrderBy">
                <span class="form-bar"></span>
                <label class="float-label"> Order By:</label>
            </div>

            <table id="GiftTable" class="table table-bordered ">
                <tr>
                    <th>Image</th>
                    <th>Order By</th>
                    <th>Remove</th>
                </tr>
            </table>
            <div class="form-group row">
                <label class="col-sm-4 col-form-label"><span class="text-inverse">Is Suprise Gift Available:</span></label>
                <div class="col-sm-8" style="padding-top:8px;">
                    @*<input type="checkbox" value="" id="is_surprise_gift_available">*@
                    <input type="checkbox" checked data-toggle="toggle" data-size="normal" data-style="ios" id="is_surprise_gift_available" data-on="Available" data-off="Not Available">

                </div>
            </div>

            <div class="form-group form-default" id="SurpiseUnitPriceBlock">
                <input type="text" name="surprise_unit_price" class="form-control" id="surprise_unit_price">
                <span class="form-bar"></span>
                <label class="float-label">Unit Price:</label>
            </div>
        </div>
        <div style="padding-bottom:15px;"><h4>Color Asset</h4></div>

        <div class="form-group form-default">
            <input type="text" name="color_name_en" class="form-control" id="color_name_en">
            <span class="form-bar"></span>
            <label class="float-label">Name in English:</label>
        </div>

        <div class="form-group form-default">
            <input type="text" name="color_name_ar" class="form-control" id="color_name_ar">
            <span class="form-bar"></span>
            <label class="float-label">Name in Arabic:</label>
        </div>
         
        <div class="form-group form-default">
            <input type="text" name="color_code" class="form-control" id="color_code">
            <span class="form-bar"></span>
            <label class="float-label">Color Code:</label>
        </div>

        <div class="form-group form-default">
            <input type="text" name="colorOrderBy" class="form-control" id="colorOrderBy">
            <span class="form-bar"></span>
            <label class="float-label"> Order By:</label>
        </div>

        <div class="form-group form-default">
            @*<input type="text" name="color_img_url" class="form-control" id="color_img_url">*@
            <input type="file" id="files" name="files[]" />
            <table id="colortable" class="table table-bordered ">
                <tr>
                    <th>Image</th>
                    <th>Name in English</th>
                    <th>Name in Arabic</th>
                    <th>Color Code</th>
                    <th>Remove</th>
                </tr>
            </table>
            @*<input type="file" id="colorimgfile" name="colorimgfile" />*@
            <span class="form-bar"></span>
            <label class="float-label">Upload Color Images:</label>
        </div>
        @*<div class="form-group" style="text-align:center;">
                <div class="col-sm-4">
                    <input type="button" class="btn-primary" value="Add Color" id="addcolorimg" />
                </div>
            </div>*@

        <div class="row m-t-30">
            <div class="col-md-4">
            </div>
            <div class="col-md-5">
                <button type="button" id="Save" class="btn btn-primary btn-md btn-block waves-effect waves-light text-center m-b-20">Save Product</button>
            </div>
            <div class="col-md-5">
            </div>
        </div>

    </form>
</div>


<script>
    $(document).ready(function () {
        getBrands();
        getCategorys();
        getTag();
    });



    //select statement Code for Brand and Category
    var brandId, categoryId;
    jQuery(document).ready(function ($) {
        $("#brandDropDownList").on('change', function () {
            brandId = $('#brandDropDownList').val();
        })
    })

    jQuery(document).ready(function ($) {
        $("#categoryDropDownList").on('change', function () {
            categoryId = $('#categoryDropDownList').val();
        })
    })
    //End

    jQuery(document).ready(function ($) {
        $("#tagDropDownList").on('change', function () {
            tagId = $('#tagDropDownList').val();
        })
    })

    //Checked Code for Checkbox
    var isDefault, iscustomsizeavailable, issurprisegiftavailable, isgiftavailable;

        $("#isdefault").change(function () {
            isDefault = $("#isdefault").is(':checked');
            alert(isDefault);
        });


    jQuery(document).ready(function ($) {
        $("#iscustomsizeavailable").change(function () {
            iscustomsizeavailable = $("#iscustomsizeavailable").is(':checked');
            if (iscustomsizeavailable == true) {
                $("#sizeBlock").show();
            }
            else {
                $("#sizeBlock").hide();
            }
        });
    });




    $("#isgiftavailable").change(function () {
        isgiftavailable = $("#isgiftavailable").is(':checked');
        if (isgiftavailable == true) {
            $("#GiftBlock").show();
        }
        else {
            $("#GiftBlock").hide();
        }

    });
    $("#is_surprise_gift_available").change(function () {
        issurprisegiftavailable = $("#is_surprise_gift_available").is(':checked');
        if (issurprisegiftavailable == true) {
            $("#SurpiseUnitPriceBlock").show();
        }
        else {
            $("#SurpiseUnitPriceBlock").hide();
        }

    });



    function getBrands() {
        $.ajax({
            async: true,
            type: "Get",
            dataType: "JSON",
            contentType: 'application/json;',
            url: 'http://localhost:51412/Products/ShowBrands',
            data: '{}',
            processing: true,
            serverSide: true,
            success: function (data) {
                var response = JSON.parse(data.data);
                $('#brandDropDownList').html('');
                var options = '';
                options += '<option value="Select">Select Brand</option>';
                for (var i = 0; i < response.length; i++) {
                    options += '<option value="' + response[i].brand_id + '">' + response[i].name_brand_en + '</option>';
                }
                $('#brandDropDownList').append(options);
            }

        })
    };
    function getCategorys() {
        $("#sizeBlock").hide();
        $("#GiftBlock").hide();
        $("#SurpiseUnitPriceBlock").hide();
        $.ajax({
            async: true,
            type: "Get",
            dataType: "JSON",
            contentType: 'application/json;',
            url: 'http://localhost:51412/Products/GetCategorys',
            data: '{}',
            processing: true,
            serverSide: true,
            success: function (data) {
                var response = JSON.parse(data.data);
                $('#categoryDropDownList').html('');
                var options = '';
                options += '<option value="Select">Select Category</option>';
                for (var i = 0; i < response.length; i++) {
                    options += '<option value="' + response[i].id + '">' + response[i].name_en + '</option>';
                }
                $('#categoryDropDownList').append(options);
            }

        })
    };

    function getTag() {
        $.ajax({
            async: true,
            type: "Get",
            dataType: "JSON",
            contentType: 'application/json;',
            url: 'http://localhost:51412/Tags/GetTags',
            data: '{}',
            dataSrc: "",
            processing: true,
            serverSide: true,
            success: function (result) {
                var response = JSON.parse(result.data);
                $.each(response, function (i, key) {
                    var options = '';
                    //options += '<option value="Select">Select Tag</option>';
                    options += '<option value="' + key.tag_id + '">' + key.tag_name_en + '</option>';
                    $('#tagDropDownList').append(options);

                })
            }
        });
    }

    $(document).ready(function () {
        $("#fileButton").click(function () {
            var files = $("#prodImageUrl").get(0).files;
            var fileData = new FormData();

            for (var i = 0; i < files.length; i++) {
                fileData.append("prodImageUrl", files[i]);
            }

            $.ajax({
                type: "POST",
                url: "/Products/UploadFiles",
                dataType: "json",
                contentType: false, // Not to set any content header
                processData: false, // Not to process data
                data: fileData,
                success: function (result, status, xhr) {
                    alert(result);
                },
                error: function (xhr, status, error) {
                    alert(status);
                }
            });
        });

        $(document).ajaxStart(function () {

            $("#fileButton").prop('disabled', true);
        });

        $(document).ajaxStop(function () {
            $("#fileButton").prop('disabled', false);

        });

    });


    var arrgiftCard = [];

    function AddGift() {
        var res = new object();


        var ColorNameEng = document.getElementById('ColorNameEng').value;
        var ColorNameAr = document.getElementById('ColorNameAr').value;
        var ColorCode = document.getElementById('ColorCode').value;
        var ColorOrderBy = document.getElementById('ColorOrderBy').value;

        res.ColorNameEng = ColorNameEng;
        res.ColorNameAr = ColorNameAr;
        res.ColorCode = ColorCode;
        res.ColorOrderBy = ColorOrderBy;
        arrgiftCard.push(res);

        $.each(arrgiftCard, function (i, key) {
            $('#Color tr:last').after
                ('<tr><td>' + key.ColorNameEng + '</td><td>' + key.ColorNameAr + '</td><td>' + key.ColorCode + '</td><td>' + key.ColorOrderBy + '</td><tr>');
        });

        ;
        alert(arr);

    }

    function RemoveGift() {
        for (var i = 0; i < arr.length; i++) {

            if (arr[i] === 'james') {
                arr.splice(i, 1);
                alert(arr);
            }
        }

    }

    //start Color

    var AssetArray = [];
 

    function fun() {
        var t = $("#isdefault").is(':checked');
        alert(t);
    }

    $(document).ready(function () {
        var type = "";
        if (window.File && window.FileList && window.FileReader) {
            $("#assertImageUrl").on("change", function (e) {
               
                var files = e.target.files,
                  filesLength = files.length;
                for (var i = 0; i < filesLength; i++) {
                    var f = files[i]
                    var fileReader = new FileReader();
                    var obj = new Object();
                    fileReader.onload = (function (e) {
                        var file = e.target;
                          type = e.target.result.substr(5, 5);
                        if (type == 'image') {

                            var newrow = $("<tr class=\"pip1\">" +
                               "<td><img class=\"imageThumb\" src=\"" + e.target.result + "\" title=\"" + file.name + "\"/></td>"
                                + "<td><input type='checkbox' id='isdefault' checked  onchange='fun()'/></td><td><input type='checkbox' id='isactive' checked data-toggle='toggle' data-size='normal' data-style='ios' data-on='Yes' data-off='No'/></td><td><span class=\"remove\">Remove</span></td></tr>");
                            $("#productImgtable").append(newrow);

                        }
                        else {
                             
                            var newrow = $("<tr class=\"pip1\">" +
                                 "<td><video width='160' height='100' controls><source src=\"" + e.target.result +"\" type='video/mp4'> </video></td>"
                                  + "<td><input type='checkbox' id='isdefault' checked  onchange='fun()'/></td><td><input type='checkbox' id='isactive' checked data-toggle='toggle' data-size='normal' data-style='ios' data-on='Yes' data-off='No'/></td><td><span class=\"remove\">Remove</span></td></tr>");
                            $("#productImgtable").append(newrow);
                        }
                            

                        $(".remove").click(function () {
                            //$(this).parent(".pip1").remove();
                            $(this).closest('tr').remove();
                        });

                    });

                    obj["is_default"] = $('#isdefault').val();
                    obj["is_active"] = $('#isactive').val();
                    obj["type"] = type;
                    obj["img_url"] = f.name;
                



                    fileReader.readAsDataURL(f);

                    AssetArray.push(obj);
                }

                console.log(AssetArray);
                console.log(files);
                
            });
        } else {
            alert("Your browser doesn't support to File API")
        }
    });


    //End Color

    $('#Save').click(function () {
        var prodlist = [];
        prod = {};

        prod['name_en'] = $("#name_en").val();
        prod['name_ar'] = $("#name_ar").val();

        prod['brand_id'] = $("#brandDropDownList").val();
        prod['cat_id'] = $("#categoryDropDownList").val();
        prod['tag_id'] = $("#tagDropDownList").val();
        prod['order_by'] = $("#prodorder_by").val();
        prod['is_active'] = $("#is_active").val();
        prod['icon_url'] = $("#IconUrl").val();
        prod['name_desc_en'] = $("#name_desc_en").val();
        prod['name_desc_ar'] = $("#name_desc_ar").val();
        prod['quantity'] = $("#quantity").val();
        prod['unit_price'] = $("#unit_price").val();

        prod['size_chart_img_url'] = $("#size_chart_img_url").val();
        prod['age_from'] = $("#agefrom").val();
        prod['age_to'] = $("#ageto").val();

        var asset = {};
         
       
        var NewAssert = [];
        NewAssert.push(AssetArray);
        prod['asset'] = NewAssert;

      
   

 


        var proddata = JSON.stringify({
            e: prod
        });

        var formData = new FormData();
        var files = $("#assertImageUrl").get(0).files;
        for(var i=0;i<files.length;i++){
            formData.append(files[i].name, files[i]);
        }
      

        //var proddata = JSON.stringify({
        //    e: prod  
        //});
        formData.append("asset", JSON.stringify(prod));
       
        
        $.ajax({
            async: true,
            type: "POST",
            dataType: "JSON",
            contentType: 'application/json;',
           
            url:'@Url.Action("AddProductJson", "Products")',
            data: formData,
           
            processData: false,
            contentType: false,
            success: function (response) {
                alert("Inserted Successfully");
            }

        })
    });

</script>
